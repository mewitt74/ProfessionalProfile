<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STAR Stories | Compliance Leadership Portfolio</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* STAR Stories Specific Styles */
        .stories-section {
            margin-bottom: 25px;
        }

        .stories-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 18px;
            margin-bottom: 20px;
        }

        @media (max-width: 968px) {
            .stories-grid {
                grid-template-columns: 1fr;
            }
        }

        .story-card {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 22px;
            box-shadow: var(--shadow-md);
            border-left: 6px solid var(--primary);
            cursor: pointer;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .story-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(33, 128, 195, 0.05) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .story-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-lg);
        }

        .story-card:hover::before {
            opacity: 1;
        }

        .story-number {
            display: inline-block;
            background: var(--primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            text-align: center;
            line-height: 32px;
            font-weight: 700;
            font-size: 16px;
            margin-bottom: 10px;
            transition: var(--transition);
        }

        .story-card:hover .story-number {
            background: var(--primary-dark);
            transform: scale(1.1) rotate(5deg);
        }

        .story-title {
            font-size: 16px;
            color: var(--text);
            margin-bottom: 10px;
            font-weight: 700;
            line-height: 1.3;
        }

        .story-card:hover .story-title {
            color: var(--primary);
        }

        .headline-metric {
            font-size: 26px;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 10px;
            line-height: 1.1;
        }

        .story-card:hover .headline-metric {
            color: var(--primary-dark);
            transform: scale(1.05);
        }

        .secondary-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .metric {
            background: var(--bg-light);
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid var(--primary);
            transition: var(--transition);
        }

        .story-card:hover .metric {
            background: rgba(33, 128, 195, 0.1);
        }

        .metric-label {
            font-size: 10px;
            color: var(--text-light);
            text-transform: uppercase;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 14px;
            color: var(--text);
            font-weight: 700;
            margin-top: 3px;
        }

        .story-description {
            font-size: 13px;
            color: var(--text-light);
            line-height: 1.5;
            border-top: 1px solid var(--border);
            padding-top: 12px;
        }

        .read-more {
            display: inline-block;
            margin-top: 10px;
            color: var(--primary);
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: var(--transition);
        }

        .story-card:hover .read-more {
            color: var(--primary-dark);
            transform: translateX(4px);
        }

        /* Audio Controls */
        .audio-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border);
        }

        .play-button {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 18px;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(33, 128, 195, 0.3);
        }

        .play-button:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(33, 128, 195, 0.5);
        }

        .play-button:active {
            transform: scale(0.95);
        }

        .play-button.playing {
            background: var(--accent);
        }

        .audio-label {
            font-size: 12px;
            color: var(--text-light);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .voice-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .voice-button {
            background: var(--bg-light);
            border: 1px solid var(--border);
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 11px;
            cursor: pointer;
            transition: var(--transition);
            color: var(--text);
        }

        .voice-button:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .voice-button.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background-color: var(--bg-white);
            margin: 10% auto;
            padding: 40px;
            border-radius: 12px;
            width: 90%;
            max-width: 700px;
            box-shadow: var(--shadow-lg);
            animation: slideUp 0.3s ease;
            max-height: 80vh;
            overflow-y: auto;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
        }

        .modal-title {
            font-size: 24px;
            color: var(--text);
            font-weight: 700;
            margin: 0;
        }

        .modal-subtitle {
            font-size: 14px;
            color: var(--primary);
            font-weight: 600;
            margin: 5px 0 0 0;
        }

        .close {
            font-size: 28px;
            font-weight: bold;
            color: var(--text-light);
            cursor: pointer;
            transition: color 0.2s ease;
            line-height: 1;
            background: none;
            border: none;
        }

        .close:hover {
            color: var(--text);
        }

        .modal-section {
            margin-bottom: 20px;
        }

        .modal-section h4 {
            font-size: 14px;
            color: var(--primary);
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .modal-section ul {
            margin-left: 20px;
            font-size: 14px;
            color: var(--text-light);
            line-height: 1.8;
        }

        .modal-section li {
            margin-bottom: 8px;
        }

        .modal-metric-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 10px;
        }

        .modal-metric {
            background: var(--bg-light);
            padding: 12px;
            border-left: 4px solid var(--primary);
            border-radius: 6px;
        }

        .modal-metric-label {
            font-size: 11px;
            color: var(--text-light);
            text-transform: uppercase;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .modal-metric-value {
            font-size: 18px;
            color: var(--text);
            font-weight: 700;
            margin-top: 4px;
        }

        .partnerships-section {
            background: var(--bg-white);
            border-radius: 8px;
            padding: 30px;
            margin-top: 20px;
            box-shadow: var(--shadow-md);
        }

        .partnerships-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .partnership-card {
            text-align: center;
            padding: 20px;
            background: var(--bg-light);
            border-radius: 8px;
            border-top: 4px solid var(--primary);
            transition: var(--transition);
        }

        .partnership-card:hover {
            background: rgba(33, 128, 195, 0.1);
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
        }

        .partnership-stakeholder {
            font-size: 18px;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 10px;
        }

        .partnership-description {
            font-size: 13px;
            color: var(--text-light);
            line-height: 1.6;
        }

        .star-stories-header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
        }

        .star-stories-header h1 {
            color: var(--primary);
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .star-stories-header p {
            color: var(--text-light);
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <!-- Dark Mode Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle dark mode">
        <span class="theme-toggle-icon" id="themeIcon">üåô</span>
        <span id="themeLabel">Dark</span>
    </button>
    <header role="banner">
        <div class="header-content">
            <div>
                <div class="logo"><a href="index.html">Melissa Witte-Spencer</a></div>
                <div class="logo-subtitle">Senior Compliance Technical Program Manager | ISO/IEC 27001:2022 Lead Auditor, ISO/IEC 42001:2023 Lead Auditor, ISO 37001 Lead Implementer</div>
            </div>
        </div>
    </header>

    <div class="container" id="main-content">
        <div class="star-stories-header">
            <h1>‚≠ê STAR Stories</h1>
            <p>Situation, Task, Action, Result - Real-world compliance impact and achievements</p>
        </div>

        <div class="stories-section">
            <div class="stories-grid" id="storiesGrid">
                <!-- Stories will be populated by JavaScript -->
            </div>
        </div>

        <div class="partnerships-section">
            <h2 class="section-title">Key Stakeholder Partnerships</h2>
            <div class="partnerships-grid">
                <div class="partnership-card">
                    <div class="partnership-stakeholder">Executive Leadership</div>
                    <div class="partnership-description">Close collaboration with C-suite to align compliance with business objectives and strategy</div>
                </div>
                <div class="partnership-card">
                    <div class="partnership-stakeholder">Compliance Teams</div>
                    <div class="partnership-description">Partner with compliance professionals across regions to drive consistency and best practices</div>
                </div>
                <div class="partnership-card">
                    <div class="partnership-stakeholder">Technology Partners</div>
                    <div class="partnership-description">Work with vendors and platforms to implement compliance automation and monitoring</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Full Stories -->
    <div id="storyModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <h2 class="modal-title" id="modalTitle"></h2>
                    <p class="modal-subtitle" id="modalSubtitle"></p>
                </div>
                <button class="close" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody"></div>
        </div>
    </div>

    <!-- Floating Navigation -->
    <nav class="floating-nav" id="floatingNav" aria-label="Quick navigation menu">
        <div class="nav-menu" id="navMenu" role="menu">
            <button class="nav-menu-item" onclick="window.location.href='index.html'" role="menuitem" aria-label="Navigate to Home">
                <span class="nav-menu-icon" aria-hidden="true">üè†</span>
                <span>Home</span>
            </button>
            <button class="nav-menu-item" onclick="window.location.href='index.html#experience'" role="menuitem" aria-label="Navigate to Experience">
                <span class="nav-menu-icon" aria-hidden="true">üíº</span>
                <span>Experience</span>
            </button>
            <button class="nav-menu-item" onclick="window.location.href='index.html#certifications'" role="menuitem" aria-label="Navigate to Credentials">
                <span class="nav-menu-icon" aria-hidden="true">üéì</span>
                <span>Credentials</span>
            </button>
            <button class="nav-menu-item" onclick="window.location.href='index.html#expertise'" role="menuitem" aria-label="Navigate to Impact">
                <span class="nav-menu-icon" aria-hidden="true">üí°</span>
                <span>Impact</span>
            </button>
            <button class="nav-menu-item" onclick="window.location.href='index.html#references'" role="menuitem" aria-label="Navigate to Testimonials">
                <span class="nav-menu-icon" aria-hidden="true">‚≠ê</span>
                <span>Testimonials</span>
            </button>
            <button class="nav-menu-item active" onclick="window.location.href='star-stories.html'" role="menuitem" aria-label="Open STAR Stories">
                <span class="nav-menu-icon" aria-hidden="true">üåü</span>
                <span>STAR Stories</span>
            </button>
            <button class="nav-menu-item" onclick="window.location.href='iso-matrix.html'" role="menuitem" aria-label="Navigate to ISO Matrix">
                <span class="nav-menu-icon" aria-hidden="true">üìä</span>
                <span>ISO Matrix</span>
            </button>
            <button class="nav-menu-item" onclick="window.location.href='index.html#volunteer'" role="menuitem" aria-label="Navigate to Volunteer">
                <span class="nav-menu-icon" aria-hidden="true">ü§ù</span>
                <span>Volunteer</span>
            </button>
        </div>
        <button class="nav-toggle" id="navToggle" onclick="toggleNavMenu()" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="navMenu">
            <span aria-hidden="true">‚ò∞</span>
        </button>
    </nav>

    <script>
        // STAR Stories Data with Full Scripts
        const stories = [
            {
                number: 1,
                title: "SOX/IT Control Design: Policy Exception Program",
                metric: "21%",
                metricLabel: "Cycle Time Reduction",
                metrics: [
                    { label: "Growth Handled", value: "46% YoY" },
                    { label: "Audit Accuracy", value: "96.5%" }
                ],
                description: "Redesigned Microsoft's global Policy Exception program supporting SOX, reducing cycle time by 21% while maintaining 96.5% audit accuracy.",
                fullScript: "At Company A, I owned the global Policy Exception, or PXR, program that supported SOX and other regulatory frameworks. Volume of exceptions was growing about 46% year over year, and our legacy workflow was slow, manual, and hard to audit. My task was to redesign the exception control framework and tooling so that decisions were faster, consistently risk‚Äëbased, and produced clean evidence for Internal Audit and Finance. I started by mapping the end‚Äëto‚Äëend process with stakeholders from Finance, Internal Audit, and Engineering, and identifying where risk decisions were being made informally in email instead of in the system. Then I defined standardized control patterns for exceptions: required approvers by risk tier, mandatory fields, expiry rules, and evidence attachments. I partnered with Engineering to embed these rules into the PXR tooling so routing, segregation of duties, and approvals were enforced automatically. In parallel, I worked with Finance and Internal Audit to validate that the new model still supported their SOX assertions and that they could rely on the system data as primary evidence. As a result, we reduced exception cycle time by 21% while absorbing 46% year‚Äëover‚Äëyear growth in volume, and we maintained roughly 96.5% audit accuracy across the related controls. Audit teams also reported that pulling evidence directly from the tool instead of email threads significantly reduced their effort."
            },
            {
                number: 2,
                title: "Preventive Controls: Asset Data Quality",
                metric: "99.6%",
                metricLabel: "Data Accuracy Achieved",
                metrics: [
                    { label: "Assets Tracked", value: "3.4M+" },
                    { label: "Improvement", value: "65% to 99.6%" }
                ],
                description: "Led Global Asset Data Quality Program at Microsoft, improving accuracy from 65% to 99.6% across 3.4 million assets through preventive controls.",
                fullScript: "One example is when I led the Global Asset Data Quality Program for Company A's datacenter environment. We had only about 65% accuracy across 3.4 million assets, which undermined the reliability of downstream compliance and financial reporting. My task was to design a preventive control architecture that would raise data quality to an acceptable level and make it sustainable without constant clean‚Äëup projects. I partnered with Finance, Operations, and Engineering to define what 'good' asset data meant‚Äîmandatory fields, allowed values, and ownership rules. I then worked with Engineering to embed validation logic and required fields directly into the source systems, so new or updated records had to meet our standards before being saved. To reinforce the controls, I designed dashboards and reporting that highlighted non‚Äëcompliant records and integrated them into regular business reviews, and I aligned with Internal Audit so that these upstream controls would be recognized as part of our SOX control set. That preventive approach improved data accuracy from 65% to 99.6% across 3.4 million assets, significantly reducing audit findings and manual reconciliation work. It also increased confidence in the integrity of reports that Audit and Finance relied on."
            },
            {
                number: 3,
                title: "Cross-Functional Partnership: Controls Monitoring Framework",
                metric: "310",
                metricLabel: "Controls Consolidated",
                metrics: [
                    { label: "Pass Rate", value: "96.5%" },
                    { label: "On-Time Rate", value: "100%" }
                ],
                description: "Designed monitoring approach across Finance, Internal Audit, and Engineering achieving 96.5% pass rate while maintaining 100% on-time compliance.",
                fullScript: "When I led the Controls Monitoring Framework, or CMF, we were consolidating over 300 controls across millions of assets. Finance and Internal Audit wanted strong assurance and detailed evidence; Engineering was concerned about overhead and disruption to their SDLC (Software Development Life Cycle). My task was to design a monitoring approach that satisfied SOX and framework requirements while fitting naturally into engineering workflows, rather than being perceived as an external audit tax. I started by running focused workshops with each group to understand their non‚Äënegotiables: Finance and Audit needed reliable coverage, clear ownership, and defensible evidence; Engineering needed automation, clear definitions, and minimal manual steps. I translated policy language into concrete technical properties‚Äîsignals, thresholds, and cadences‚Äîthat Engineering could implement in pipelines and configuration. For example, some controls were shifted from manual quarterly sampling to automated checks in tooling, with alerts when thresholds were breached. I documented these designs in a shared control catalog so all three groups saw the same control description, ownership, and monitoring method. With that approach we achieved a 96.5% pass rate across 310 controls and over 92% pass rate on 487 tests, while maintaining 100% on‚Äëtime compliance campaigns. Engineering reported lower friction because many checks became 'silent' automated controls, and Internal Audit gained more confidence because evidence was structured and repeatable."
            },
            {
                number: 4,
                title: "Compliance Automation: AI-Driven Process Agents",
                metric: "40%",
                metricLabel: "Workload Reduction",
                metrics: [
                    { label: "Volume Growth", value: "46% YoY" },
                    { label: "Real-Time Visibility", value: "Yes" }
                ],
                description: "Designed AI-driven process agents reducing manual workload by 40% while handling 46% year-over-year growth in compliance program volume.",
                fullScript: "In my most recent role, our compliance programs were scaling quickly, and manual evidence collection and status reporting were becoming a bottleneck for both engineering teams and auditors. My task was to design automation that would reduce manual workload while increasing visibility into control health for stakeholders across Security, Finance, and Internal Audit. I led the design of AI‚Äëdriven process agents that connected to our compliance tooling and data sources. These agents automatically pulled control evidence, updated status dashboards, and generated summaries for campaign owners and auditors. I defined which data elements were authoritative for each control, how often they needed to be refreshed, and what exceptions should trigger human review. I also partnered with the GRC platform team on our migration to Enablon so these agents could run against a more modern, API‚Äëdriven system that supported continuous monitoring. The automation reduced manual administrative workload by about 40% while program volume grew 46% year over year, freeing teams to focus on higher‚Äëvalue analysis and design work. At the same time, leaders had a clearer, near‚Äëreal‚Äëtime view of control health, which improved our readiness for external audits."
            }
        ];

        // Text-to-Speech functionality
        let currentSpeech = null;
        let currentPlayingCard = null;

        function initializeSpeech() {
            if ('speechSynthesis' in window) {
                return true;
            }
            console.warn('Text-to-Speech not supported in this browser');
            return false;
        }

        function stopCurrentSpeech() {
            if (currentSpeech) {
                window.speechSynthesis.cancel();
                currentSpeech = null;
                if (currentPlayingCard) {
                    updatePlayButton(currentPlayingCard, false);
                    currentPlayingCard = null;
                }
            }
        }

        function toggleSpeech(storyIndex, event) {
            event.stopPropagation(); // Prevent card click
            
            const story = stories[storyIndex];
            const button = event.currentTarget;
            
            // If currently playing this story, stop it
            if (currentPlayingCard === storyIndex) {
                stopCurrentSpeech();
                return;
            }
            
            // Stop any other playing speech
            stopCurrentSpeech();
            
            // Start new speech
            if (story.fullScript && initializeSpeech()) {
                currentSpeech = new SpeechSynthesisUtterance(story.fullScript);
                currentPlayingCard = storyIndex;
                
                // Configure speech with female voice preference
                currentSpeech.rate = 0.9; // Slightly slower for clarity
                currentSpeech.pitch = 1.0;
                currentSpeech.volume = 1.0;
                
                // Select best natural female voice
                const voices = window.speechSynthesis.getVoices();
                const femaleVoice = voices.find(voice => 
                    // Prioritize high-quality female voices
                    (voice.name.includes('Samantha') || // macOS high-quality voice
                     voice.name.includes('Zira') ||     // Windows female voice
                     voice.name.includes('Google US English') ||
                     voice.name.includes('Microsoft Aria') ||
                     voice.name.includes('Microsoft Michelle') ||
                     voice.name.includes('Karen') ||
                     voice.name.includes('Victoria') ||
                     voice.name.includes('Fiona') ||
                     voice.name.includes('female') ||
                     voice.name.includes('Female')) &&
                    voice.lang.startsWith('en')
                ) || voices.find(voice => 
                    // Fallback: any English female voice
                    voice.lang.startsWith('en') && 
                    (voice.name.toLowerCase().includes('female') ||
                     voice.name.includes('woman') ||
                     !voice.name.toLowerCase().includes('male'))
                );
                
                if (femaleVoice) {
                    currentSpeech.voice = femaleVoice;
                    console.log('Using voice:', femaleVoice.name);
                }
                
                // Event handlers
                currentSpeech.onstart = () => {
                    updatePlayButton(storyIndex, true);
                };
                
                currentSpeech.onend = () => {
                    updatePlayButton(storyIndex, false);
                    currentPlayingCard = null;
                    currentSpeech = null;
                };
                
                currentSpeech.onerror = (event) => {
                    console.error('Speech error:', event);
                    updatePlayButton(storyIndex, false);
                    currentPlayingCard = null;
                    currentSpeech = null;
                };
                
                // Start speaking
                window.speechSynthesis.speak(currentSpeech);
                updatePlayButton(storyIndex, true);
            } else if (!story.fullScript) {
                alert('Voice script not available for this story yet.');
            }
        }

        function updatePlayButton(storyIndex, isPlaying) {
            // Update all buttons for this story (both card and modal)
            const buttons = document.querySelectorAll(`.play-button[data-story="${storyIndex}"], [data-modal-story="${storyIndex}"]`);
            buttons.forEach(button => {
                button.textContent = isPlaying ? '‚è∏' : '‚ñ∂';
                button.classList.toggle('playing', isPlaying);
                button.setAttribute('aria-label', isPlaying ? 'Pause story narration' : 'Play story narration');
            });
        }

        // Theme toggle functionality
        function toggleTheme() {
            const html = document.documentElement;
            const themeIcon = document.getElementById('themeIcon');
            const themeLabel = document.getElementById('themeLabel');
            const currentTheme = html.getAttribute('data-theme');
            
            if (currentTheme === 'dark') {
                html.setAttribute('data-theme', 'light');
                themeIcon.textContent = 'üåô';
                themeLabel.textContent = 'Dark';
                localStorage.setItem('theme', 'light');
            } else {
                html.setAttribute('data-theme', 'dark');
                themeIcon.textContent = '‚òÄÔ∏è';
                themeLabel.textContent = 'Light';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Load saved theme on page load
        document.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme');
            const html = document.documentElement;
            const themeIcon = document.getElementById('themeIcon');
            const themeLabel = document.getElementById('themeLabel');
            
            if (savedTheme === 'dark') {
                html.setAttribute('data-theme', 'dark');
                themeIcon.textContent = '‚òÄÔ∏è';
                themeLabel.textContent = 'Light';
            }

            // Show floating nav
            const floatingNav = document.getElementById('floatingNav');
            if (floatingNav) {
                floatingNav.classList.add('visible');
            }

            // Populate stories
            populateStories();
        });

        // Populate stories from data
        function populateStories() {
            const grid = document.getElementById('storiesGrid');
            grid.innerHTML = stories.map((story, index) => `
                <div class="story-card" data-story="${index}">
                    <div class="card-content" onclick="openModal(${index})">
                        <div class="story-number">${story.number}</div>
                        <h3 class="story-title">${story.title}</h3>
                        <div class="headline-metric">${story.metric}</div>
                        <div style="font-size: 12px; color: var(--text-light); margin-bottom: 12px;">${story.metricLabel}</div>
                        <div class="secondary-metrics">
                            ${story.metrics.map(m => `
                                <div class="metric">
                                    <div class="metric-label">${m.label}</div>
                                    <div class="metric-value">${m.value}</div>
                                </div>
                            `).join('')}
                        </div>
                        <p class="story-description">${story.description}</p>
                        <span class="read-more">Read Full Story ‚Üí</span>
                    </div>
                    ${story.fullScript ? `
                        <div class="audio-controls">
                            <span class="audio-label">üéôÔ∏è Click Card to Hear Full STAR Story</span>
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        // Modal functions
        function openModal(index) {
            const story = stories[index];
            document.getElementById('modalTitle').textContent = story.title;
            document.getElementById('modalSubtitle').textContent = `Story #${story.number}`;
            
            const modalBody = document.getElementById('modalBody');
            modalBody.innerHTML = `
                ${story.fullScript ? `
                    <div class="modal-section">
                        <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                            <button class="play-button" 
                                    onclick="toggleSpeech(${index}, event)" 
                                    aria-label="Play story narration"
                                    style="width: 50px; height: 50px; font-size: 22px;"
                                    data-modal-story="${index}">
                                ‚ñ∂
                            </button>
                            <div>
                                <div style="font-weight: 700; color: var(--primary);">üéôÔ∏è Listen to Full STAR Story</div>
                                <div style="font-size: 12px; color: var(--text-light);">Hear the complete Situation, Task, Action, Result narrative</div>
                            </div>
                        </div>
                    </div>
                ` : ''}
                <div class="modal-section">
                    <h4>Overview</h4>
                    <p>${story.description}</p>
                </div>
                <div class="modal-section">
                    <h4>Key Metrics</h4>
                    <div class="modal-metric-row">
                        <div class="modal-metric">
                            <div class="modal-metric-label">Primary Achievement</div>
                            <div class="modal-metric-value">${story.metric} ${story.metricLabel}</div>
                        </div>
                        ${story.metrics.map(m => `
                            <div class="modal-metric">
                                <div class="modal-metric-label">${m.label}</div>
                                <div class="modal-metric-value">${m.value}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ${story.fullScript ? `
                    <div class="modal-section">
                        <h4>Full STAR Narrative</h4>
                        <p style="line-height: 1.8; color: var(--text-light);">${story.fullScript}</p>
                    </div>
                ` : `
                    <div class="modal-section">
                        <h4>Impact</h4>
                        <ul>
                            <li>Improved compliance accuracy and consistency</li>
                            <li>Reduced manual effort and operational costs</li>
                            <li>Enhanced stakeholder confidence and governance</li>
                            <li>Enabled scalability across enterprise operations</li>
                        </ul>
                    </div>
                `}
            `;
            
            document.getElementById('storyModal').style.display = 'block';
        }

        function closeModal() {
            stopCurrentSpeech(); // Stop any playing audio when modal closes
            document.getElementById('storyModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('storyModal');
            if (event.target === modal) {
                stopCurrentSpeech();
                modal.style.display = 'none';
            }
        }

        // Load voices when they become available
        if ('speechSynthesis' in window) {
            window.speechSynthesis.onvoiceschanged = () => {
                const voices = window.speechSynthesis.getVoices();
                console.log('Available voices:', voices.length);
            };
        }

        // Navigation menu toggle
        function toggleNavMenu() {
            const menu = document.getElementById('navMenu');
            const toggle = document.getElementById('navToggle');
            const isExpanded = menu.classList.contains('show');
            
            menu.classList.toggle('show');
            toggle.setAttribute('aria-expanded', !isExpanded);
        }

        // Close menu when clicking outside
        document.addEventListener('click', function(event) {
            const floatingNav = document.getElementById('floatingNav');
            const navMenu = document.getElementById('navMenu');
            const navToggle = document.getElementById('navToggle');
            
            if (floatingNav && !floatingNav.contains(event.target)) {
                navMenu.classList.remove('show');
                navToggle.setAttribute('aria-expanded', 'false');
            }
        });

        // Close menu with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const navMenu = document.getElementById('navMenu');
                const navToggle = document.getElementById('navToggle');
                if (navMenu.classList.contains('show')) {
                    navMenu.classList.remove('show');
                    navToggle.setAttribute('aria-expanded', 'false');
                    navToggle.focus();
                }
            }
        });
    </script>
</body>
</html>
